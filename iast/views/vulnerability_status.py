######################################################################
# @author      : bidaya0 (bidaya0@$HOSTNAME)
# @file        : vulnerability_status
# @created     : Friday Aug 27, 2021 15:34:34 CST
#
# @description :
######################################################################



from dongtai.models.vulnerablity import IastVulnerabilityStatus
from dongtai.endpoint import R
from dongtai.endpoint import UserEndPoint
from django.forms.models import model_to_dict

class VulnerabilityStatusView(UserEndPoint):

    def get(self, request):
        status = IastVulnerabilityStatus.objects.all()
        return R.success(data=[model_to_dict(_) for _ in status])
