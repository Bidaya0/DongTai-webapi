######################################################################
# @author      : bidaya0 (bidaya0@$HOSTNAME)
# @file        : vulnerability_status
# @created     : Friday Aug 27, 2021 15:34:34 CST
#
# @description :
######################################################################



from dongtai.models.vulnerablity import IastVulnerabilityStatus
from dongtai.endpoint import R
from dongtai.endpoint import UserEndPoint
from django.forms.models import model_to_dict
from iast.utils import extend_schema_with_envcheck
from django.utils.translation import gettext_lazy as _

class VulnerabilityStatusView(UserEndPoint):

    @extend_schema_with_envcheck(
        tags=[_('Vulnerability')],
        summary=_("Vulnerability Status List"),
        description=
        _("""Vulnerability status list, which contains the optional status of vulnerabilities. 
            When calling the vulnerability status modification API, please obtain the vulnerability status data from this API first."""
          ),
    )
    def get(self, request):
        status = IastVulnerabilityStatus.objects.all()
        return R.success(data=[model_to_dict(_) for _ in status])
